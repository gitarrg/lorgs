{% from "elements/timeline_player_name.html" import player_name %}
{% from "elements/timeline_player_name.html" import boss_name %}
{% from "elements/timeline_ruler.html" import timeline_ruler %}
{% from "elements/timeline_killtime.html" import killtime %}
{% from "elements/timeline_casts.html" import player_timeline %}


{% macro header_boss(boss, spec) -%}
<h1 class="m-0">
    <a href="https://www.warcraftlogs.com/zone/rankings/{{boss.zone.id}}#boss={{boss.id}}&class={{spec.wow_class.name_slug_cap}}&spec={{spec.name_slug_cap}}&metric={{spec.role.metric}}" target="_blank">
        <img class="icon-l rounded shadow wow-class-border-{{spec.wow_class.name_slug}}" src="{{spec.icon_path}}">
        <span class="wow-class-{{spec.wow_class.name_slug}}">{{spec.full_name}}s</span>
        <span>vs</span>
        <img class="icon-l rounded shadow border-white" src="{{boss.icon_path}}" alt="{{boss.name}}" target="_blank">
        <span>{{boss.name}}</span>
    </a>
</h1>
{%- endmacro %}

{##############################################################################}

{% extends "base.html" %}

{##############################################################################}
{# TITLE #}

{%- block title %}
Lorgs: {{spec.full_name}} vs. {{boss.name}}
{%- endblock -%}

{##############################################################################}
{# HEADER #}

{% block header -%}
<div class="mt-3 flex-row d-flex flex-wrap-reverse">
    <div class="mb-2">
    {{ header_boss(boss, spec) }}
    </div>

    <div class="ml-auto mb-2">
        {% include "elements/spec_ranking_nav.html" %}
    </div>
</div>
{% endblock %}

{##############################################################################}
{# CONTENT #}

{% block content -%}
<div class="mb-2">
    {% include "elements/settings_bar.html" %}
</div>


<!-- TIMELINES -->
<div class="p-2 bg-dark rounded border">

    <!-- Player Names -->
    <div class="player_names_container spec_ranking float-left">
        <div class="timeline_ruler_playerholder"></div>
        {# Boss #}
        {% if boss_player %}
        {{ boss_name(boss_player) }}
        {% endif %}

        {# Players #}
        {% for player in players %}
            {{ player_name(player, loop.index) }}
        {% endfor %}
    </div>

    <div class="player_timelines_container">
        {{ timeline_ruler(timeline_duration) }}
        {% include "elements/timeline_cursor.html" %}


        {# Boss #}
        {% if boss_player %}
        {{ player_timeline(boss_player) }}
        {% endif %}

        {# Players #}
        {% for player in players %}
            {{ player_timeline(player) }}
        {%- endfor %}
    </div>
</div>
{% endblock %}

{##############################################################################}

<!-- Content Scripts -->
{% block scripts %}
<script src="{{url_for('static',filename='spells.js')}}"></script>
<script src="{{url_for('static',filename='timeline.js')}}"></script>
{{ super() }}
{% endblock %}
